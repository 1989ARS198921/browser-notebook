<!-- templates/read_article.html -->
<!-- -*- coding: utf-8 -*- -->
{% extends "base.html" %}
{% block sidebar %}
    {% include 'sidebar.html' %}
{% endblock %}

{% block title %}{{ note.title }}{% endblock %}

{% block breadcrumbs %}
<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{{ url_for('index') }}">Главная</a></li>
        <li class="breadcrumb-item"><a href="{{ url_for('wall') }}">Стена</a></li>
        <li class="breadcrumb-item active" aria-current="page">{{ note.title }}</li>
    </ol>
</nav>
{% endblock %}

{% block content %}
<div class="content-card reading-container">
    <div class="card-header">
        <a href="{{ url_for('wall') }}" class="btn btn-secondary">← Назад к стене</a>
        {% if current_user.is_authenticated and current_user.is_admin %}
            <a href="{{ url_for('edit_article', id=note.id) }}" class="btn btn-edit">Редактировать статью</a>
        {% endif %}
        <h1>{{ note.title }}</h1>
    </div>

    {% if note_categories %}
        <p class="article-categories">
            <strong>Категории:</strong>
            {% for cat in note_categories %}
                <span class="tag">{{ cat.name }}</span>
            {% endfor %}
        </p>
    {% endif %}

    {% if note.tags %}
        <p class="article-tags">
            <strong>Теги:</strong>
            {% for tag in note.tags.split(',') %}
                <span class="tag">{{ tag.strip() }}</span>
            {% endfor %}
        </p>
    {% endif %}

    {% if note.preview_image %}
        <div class="article-preview-image-full">
            <img src="{{ url_for('static', filename='uploads/' + note.preview_image) }}" alt="Превью статьи" style="max-width: 100%;">
        </div>
    {% endif %}

    {% if note.summary %}
        <div class="article-summary-full">
            <h3>Аннотация</h3>
            <p>{{ note.summary }}</p>
        </div>
    {% endif %}

    <!-- Основное содержимое статьи в режиме чтения -->
    <div class="article-content-full reader-mode-article">
        {{ display_content | safe }}
    </div>

    <p class="article-date-full"><small>Опубликовано: {{ note.created_at.strftime('%d.%m.%Y %H:%M') }}, Обновлено: {{ note.updated_at.strftime('%d.%m.%Y %H:%M') }}</small></p>
</div>
{% endblock %}